{
    "nodes": [
        {
            "id": "node_start",
            "type": "start",
            "label": "Start",
            "position": {
                "x": 250,
                "y": 0
            },
            "data": {
                "initial_value": "Write a short 3-chapter story about an astronaut lost on Mars."
            }
        },
        {
            "id": "node_planner",
            "type": "llm",
            "label": "Planner LLM",
            "position": {
                "x": 250,
                "y": 150
            },
            "data": {
                "system_prompt": "Break the user's request into a list of 3 sub-tasks. Output JSON: {\"plan\": [\"...\", \"...\", \"...\"]}",
                "user_prompt": "Goal: {input}"
            }
        },
        {
            "id": "node_extractor",
            "type": "variable_extractor",
            "label": "Extract Plan",
            "position": {
                "x": 250,
                "y": 300
            },
            "data": {
                "mapping": "{\"plan\": \"tasks\"}"
            }
        },
        {
            "id": "node_batch",
            "type": "sequential_batch",
            "label": "Sequential Batch",
            "position": {
                "x": 250,
                "y": 450
            },
            "data": {
                "items_key": "tasks",
                "current_item_var": "current_task"
            }
        },
        {
            "id": "node_executor",
            "type": "llm",
            "label": "Task Executor",
            "position": {
                "x": 0,
                "y": 600
            },
            "data": {
                "system_prompt": "Execute the following sub-task for the Mars story.",
                "user_prompt": "Current Task: {current_task}"
            }
        },
        {
            "id": "node_collector",
            "type": "file_write",
            "label": "Save Chapter",
            "position": {
                "x": 0,
                "y": 750
            },
            "data": {
                "path": "story.txt",
                "mode": "a"
            }
        },
        {
            "id": "node_finish",
            "type": "debug",
            "label": "Draft Complete",
            "position": {
                "x": 500,
                "y": 600
            },
            "data": {
                "message": "Story written to story.txt"
            }
        }
    ],
    "edges": [
        {
            "id": "e1",
            "source": "node_start",
            "target": "node_planner"
        },
        {
            "id": "e2",
            "source": "node_planner",
            "target": "node_extractor"
        },
        {
            "id": "e3",
            "source": "node_extractor",
            "target": "node_batch"
        },
        {
            "id": "e4",
            "source": "node_batch",
            "target": "node_executor",
            "sourceHandle": "each"
        },
        {
            "id": "e5",
            "source": "node_executor",
            "target": "node_collector"
        },
        {
            "id": "e6",
            "source": "node_collector",
            "target": "node_batch"
        },
        {
            "id": "e7",
            "source": "node_batch",
            "target": "node_finish",
            "sourceHandle": "done"
        }
    ]
}